<!DOCTYPE html>
<html prefix="og: https://ogp.me/ns# fb: https://ogp.me/ns/fb# article: https://ogp.me/ns/article#" lang="en-US">
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="profile" href="http://gmpg.org/xfn/11"><link rel="pingback" href="https://linux-audit.com/xmlrpc.php"><meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><link media="all" href="autoptimize_57a4a401161f04621e983333e8bf080d.css" rel="stylesheet"><title>The ultimate strace cheat sheet - Linux Audit</title><meta name="description" content="The strace utility is diverse and helpful in performance tuning, troubleshooting and monitoring process activity. This cheat sheet helps with getting the most out of strace."><link rel="canonical" href="https://linux-audit.com/the-ultimate-strace-cheat-sheet/"><link rel="dns-prefetch" href="https://linux-audit.com/"><link rel="alternate" type="application/rss+xml" title="Linux Audit » Feed" href="https://linux-audit.com/feed/"><link rel="alternate" type="application/rss+xml" title="Linux Audit » Comments Feed" href="https://linux-audit.com/comments/feed/"><link rel="alternate" type="application/rss+xml" title="Linux Audit » The ultimate strace cheat sheet Comments Feed" href="https://linux-audit.com/the-ultimate-strace-cheat-sheet/feed/"><script type="text/javascript" src="about:blank" id="jquery-core-js"></script> <script type="text/javascript" id="rubine-lite-jquery-navigation-js-extra">/* Code removed by ScrapBook */</script><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://linux-audit.com/xmlrpc.php?rsd"><link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://linux-audit.com/wp-includes/wlwmanifest.xml"><link rel="alternate" type="application/json+oembed" href="https://linux-audit.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Flinux-audit.com%2Fthe-ultimate-strace-cheat-sheet%2F"><link rel="alternate" type="text/xml+oembed" href="https://linux-audit.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Flinux-audit.com%2Fthe-ultimate-strace-cheat-sheet%2F&amp;format=xml"><link rel="manifest" href="https://linux-audit.com/manifest.json"><meta name="theme-color" content="#235CCE"><meta name="wpsso-begin" content="wpsso meta tags and schema markup begin"><link rel="shortlink" href="https://linux-audit.com/?p=1603"><meta property="fb:app_id" content="966242223397117"><meta property="og:type" content="article"><meta property="og:url" content="https://linux-audit.com/the-ultimate-strace-cheat-sheet/"><meta property="og:locale" content="en_US"><meta property="og:site_name" content="Linux Audit"><meta property="og:title" content="The ultimate strace cheat sheet"><meta property="og:description" content="The strace utility is diverse and helpful in performance tuning, troubleshooting and monitoring process activity. This cheat sheet helps with getting the most out of strace."><meta property="og:updated_time" content="2015-07-05T20:15:20+00:00"><meta property="og:image" content="https://assets.linux-audit.com/wp-content/uploads/2015/07/strace-overview-of-syscalls.png"><meta property="og:image:width" content="569"><meta property="og:image:height" content="635"><meta property="og:image:alt" content="screenshot of strace utility with -c parameter"><meta property="article:published_time" content="2015-07-06T18:14:53+00:00"><meta property="article:modified_time" content="2015-07-05T20:15:20+00:00"><meta property="article:tag" content="debugging"><meta property="article:tag" content="linux"><meta property="article:tag" content="strace"><meta property="article:tag" content="troubleshooting"><meta name="twitter:domain" content="linux-audit.com"><meta name="twitter:site" content="@linuxaudit"><meta name="twitter:title" content="The ultimate strace cheat sheet"><meta name="twitter:description" content="The strace utility is diverse and helpful in performance tuning, troubleshooting and monitoring process activity. This cheat sheet helps with getting the most out of strace."><meta name="twitter:creator" content="@mboelen"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://assets.linux-audit.com/wp-content/uploads/2015/07/strace-overview-of-syscalls.png?p=1603"><meta name="twitter:image:alt" content="screenshot of strace utility with -c parameter"><meta name="twitter:label1" content="Written by"><meta name="twitter:data1" content="Michael Boelen"><meta name="twitter:label2" content="Est. reading time"><meta name="twitter:data2" content="3 minutes"><meta name="author" content="Michael Boelen"><meta name="thumbnail" content="https://assets.linux-audit.com/wp-content/uploads/2015/07/strace-overview-of-syscalls.png"><script type="application/ld+json">/* Code removed by ScrapBook */</script><meta name="wpsso-end" content="wpsso meta tags and schema markup end"><meta name="wpsso-cached" content="2022-03-16T21:20:51+00:00"><meta name="wpsso-added" content="2022-03-20T02:02:21+00:00 in 0.000959 secs for linux-audit.com"><link rel="amphtml" href="https://linux-audit.com/the-ultimate-strace-cheat-sheet/amp/"><style>
/* Code tidied up by ScrapBook */
</style></head>
<body class="post-template-default single single-post postid-1603 single-format-standard"><div id="wrapper" class="hfeed"><div id="wrap" class="container clearfix"><section id="content" class="primary" role="main"><article id="post-1603" class="clearfix post-1603 post type-post status-publish format-standard hentry category-auditing category-performance tag-debugging tag-linux tag-strace tag-troubleshooting"><div class="post-content"><!--DOCUMENT_FRAGMENT--><h1 class="entry-title post-title"><span>The ultimate strace cheat sheet</span></h1><div class="entry clearfix"><h1>Strace cheat sheet</h1><p>The strace utility is very powerful to learn what a new or running process is doing. Due to its diversity of monitoring options, the tool is less accessible at first. This strace cheat sheet helps with getting the best out of this tool.</p><p>Normally cheat sheets come in a single 1 page PDF. In this case, we combined it all within a blog post. First section shows an explanation per area, the bottom of the post contains all useful commands for quick reference.</p><h2>Troubleshooting with strace</h2><p>One of options of the strace utility is to help as a troubleshooting utility. If you want to know what a process is doing, or why it hangs, strace will definitely help. By running strace without any parameters, it will already show why a process is doing. You can trace a running process, or instruct&nbsp;strace to start it for you.</p><div id="attachment_1609" style="width: 579px;" class="wp-caption alignnone"><a href="strace-overview-of-syscalls_001.png"><img aria-describedby="caption-attachment-1609" loading="lazy" class="size-full wp-image-1609" src="strace-overview-of-syscalls.png" alt="screenshot of strace utility with -c parameter" srcset="strace-overview-of-syscalls.png 569w, strace-overview-of-syscalls-269x300.png 269w" sizes="(max-width: 569px) 100vw, 569px" width="569" height="635"></a><p id="caption-attachment-1609" class="wp-caption-text">All syscalls listed by amount of time</p></div><h2>Monitoring file activity</h2><p>Strace can monitor file related activity. There are two useful parts. The first is <strong>file</strong>, which shows file interactions. The other one allows tracing&nbsp;<strong>file descriptors</strong>. Both can be used to monitor for actions like opening files, reading/writing and closing. Usually using “trace=file” provides&nbsp;enough insights. If you really need more insights in the way a program deals with file descriptors, then use the second one.</p><ul><li>Monitor opening of files: strace&nbsp;-e open</li><li>See all file activity: strace -e trace=file -p 1234 <strong>or</strong>&nbsp;strace -e trace=desc -p 1234</li></ul><p>If you want to track specific paths, use 1 or more times the <strong>-P</strong> parameter, following by the path.</p><blockquote><p># sudo strace -P /etc/cups -p 2261<br>Process 2261 attached<br>— SIGHUP {si_signo=SIGHUP, si_code=SI_USER, si_pid=6149, si_uid=0} —<br>lstat(“/etc/cups”, {st_mode=S_IFDIR|0755, st_size=4096, …}) = 0<br>openat(AT_FDCWD, “/etc/cups”, O_RDONLY|O_NONBLOCK|O_DIRECTORY|O_CLOEXEC) = 7<br>getdents(7, /* 11 entries */, 32768) = 336<br>getdents(7, /* 0 entries */, 32768) = 0<br>close(7) = 0<br>openat(AT_FDCWD, “/etc/cups”, O_RDONLY|O_NONBLOCK|O_DIRECTORY|O_CLOEXEC) = 7<br>getdents(7, /* 11 entries */, 32768) = 336<br>getdents(7, /* 0 entries */, 32768) = 0<br>close(7) = 0</p></blockquote><p>Common calls:</p><ul><li>access</li><li>close (close file handle)</li><li>fchmod&nbsp;(change file permissions)</li><li>fchown&nbsp;(change file ownership)</li><li>fstat&nbsp;(retrieve details)</li><li>lseek&nbsp;(move through file)</li><li>open (open file for reading/writing)</li><li>read (read a piece of data)</li><li>statfs (retrieve file system related details)</li></ul><p>A related example screen output:</p><div id="attachment_1605" style="width: 733px;" class="wp-caption alignnone"><a href="strace-monitoring-file-activities_001.png"><img aria-describedby="caption-attachment-1605" loading="lazy" class="size-full wp-image-1605" src="strace-monitoring-file-activities.png" alt="screenshot of strace monitoring file access and activity" srcset="strace-monitoring-file-activities.png 723w, strace-monitoring-file-activities-300x163.png 300w" sizes="(max-width: 723px) 100vw, 723px" width="723" height="392"></a><p id="caption-attachment-1605" class="wp-caption-text">Monitoring file access and activity with strace</p></div><h2>Monitoring the network</h2><p>Strace definitely can be useful for revealing more details about network traffic. Very useful to determine what network related connections are used, like when building your Docker image.</p><blockquote><p>strace -e trace=network</p></blockquote><p>Common syscalls:</p><ul><li>bind – link the process to a network port</li><li>listen – allow to receive incoming connections</li><li>socket – open a local or network socket</li><li>setsockopt&nbsp;– define options for an active socket</li></ul><h2>Monitoring memory calls</h2><p>To get better insights on the memory usage and system calls, strace can monitor for these as well. They are nicely grouped in the memory group.</p><blockquote><p>strace -e trace=memory</p></blockquote><p>Common syscalls:</p><ul><li>mmap</li><li>munmap</li></ul><hr><h2>Strace Cheat Sheet – Overview</h2><p>Useful options and examples</p><ul><li><strong>-c</strong> – See what time is spend and where (combine with -S for sorting)</li><li><strong>-f</strong> – Track process including forked child processes</li><li><strong>-o my-process-trace.txt</strong> – Log strace output to a file</li><li><strong>-p 1234</strong> – Track a process by PID</li><li><strong>-P /</strong>tmp – Track a process when interacting with a path</li><li><strong>-T</strong> – Display syscall duration in the output</li></ul><p>Track by specific system call group</p><ul><li><strong>-e trace=ipc</strong> – Track communication between processes (IPC)</li><li><strong>-e trace=memory</strong> – Track memory syscalls</li><li><strong>-e trace=network</strong> – Track memory syscalls</li><li><strong>-e trace=process</strong>&nbsp;– Track process calls (like fork, exec)</li><li><strong>-e trace=signal</strong> – Track process signal handling (like HUP, exit)</li><li><strong>-e trace=file</strong> – Track file related syscalls</li></ul><p>Trace multiple syscalls</p><ul><li>strace -e open,close</li></ul><hr><p>Got other clever stracing tips? Use the comments for inclusion!</p><div class="themezee-social-sharing tzss-content tzss-below-content tzss-style-icons tzss-socicons tzss-3-columns"><ul class="tzss-share-buttons-list"><li class="tzss-share-item"><span class="tzss-button tzss-facebook"><a class="tzss-link" href="https://www.facebook.com/sharer/sharer.php?u=https://linux-audit.com/the-ultimate-strace-cheat-sheet/&amp;t=The%20ultimate%20strace%20cheat%20sheet" target="_blank"><span class="tzss-icon"></span><span class="tzss-text screen-reader-text">Facebook</span></a></span></li><li class="tzss-share-item"><span class="tzss-button tzss-twitter"><a class="tzss-link" href="https://twitter.com/intent/tweet?text=The%20ultimate%20strace%20cheat%20sheet&amp;url=https://linux-audit.com/the-ultimate-strace-cheat-sheet/" target="_blank"><span class="tzss-icon"></span><span class="tzss-text screen-reader-text">Twitter</span></a></span></li><li class="tzss-share-item"><span class="tzss-button tzss-buffer"><a class="tzss-link" href="https://bufferapp.com/add?url=https://linux-audit.com/the-ultimate-strace-cheat-sheet/&amp;text=The%20ultimate%20strace%20cheat%20sheet" target="_blank"><span class="tzss-icon"></span><span class="tzss-text screen-reader-text">Buffer</span></a></span></li></ul></div><div class="page-links"></div></div><div class="meta-tags clearfix"><ul><li><a href="https://linux-audit.com/tag/debugging/" rel="tag">debugging</a></li><li><a href="https://linux-audit.com/tag/linux/" rel="tag">linux</a></li><li><a href="https://linux-audit.com/tag/strace/" rel="tag">strace</a></li><li><a href="https://linux-audit.com/tag/troubleshooting/" rel="tag">troubleshooting</a></li></ul></div><!--/DOCUMENT_FRAGMENT--></div></article></section></div></div></body>
</html>
